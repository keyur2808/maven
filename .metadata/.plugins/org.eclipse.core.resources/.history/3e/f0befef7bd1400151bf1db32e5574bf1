package com.cloudwick.avro;

import java.io.File;

import org.apache.avro.file.DataFileWriter;
import org.apache.avro.io.DatumWriter;
import org.apache.avro.specific.SpecificDatumWriter;

public class AvroProcessor {
	public static void main(String... args) {
		Employee emp1 = new Employee();
		emp1.setId(101);
		emp1.setName("Rhonda");
		emp1.setDesignation("Hadoop Engineer");
		emp1.setMgrid(25);
		emp1.setHiredate("05-18-2015");
		emp1.setSalary(100000d);
		emp1.setDeptid(21);

		Employee emp2 = Employee.newBuilder().setId(201).setName("Salena")
				.setDesignation("Java Programmer").setMgrid(73)
				.setHiredate("03-19-2016").setSalary(102000d).setDeptid(73)
				.setCommission(2242d).build();

		Employee emp3 = new Employee(2914, "Melissa", "Marketing Manager",
				8910, "12-12-2014", 434351d, null, 343);

		DatumWriter<Employee> userDatumWriter = new SpecificDatumWriter<Employee>(
				Employee.class);
		DataFileWriter<Employee> dataFileWriter = new DataFileWriter<Employee>(
				userDatumWriter);
		dataFileWriter.create(emp1.getSchema(), new File(""));
		dataFileWriter.append(emp1);
		dataFileWriter.append(emp2);
		dataFileWriter.append(emp3);
		dataFileWriter.close();
	}
}